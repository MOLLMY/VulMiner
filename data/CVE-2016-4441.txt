76 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c cfunc 365
static void sysbus_esp_gpio_demux(void *opaque, int irq, int level)
SysBusESPState *sysbus = ESP(opaque);
ESPState *s = &sysbus->esp;
parent_esp_reset(s, irq, level);
static void parent_esp_reset(ESPState *s, int irq, int level)
esp_soft_reset(s);
static void esp_soft_reset(ESPState *s)
qemu_irq_lower(s->irq);
esp_hard_reset(s);
void esp_hard_reset(ESPState *s)
memset(s->rregs, 0, ESP_REGS);
static void sysbus_esp_mem_write(void *opaque, hwaddr addr,
esp_reg_write(&sysbus->esp, saddr, val);
void esp_reg_write(ESPState *s, uint32_t saddr, uint64_t val)
esp_soft_reset(s);
static void sysbus_esp_hard_reset(DeviceState *dev)
SysBusESPState *sysbus = ESP(dev);
esp_hard_reset(&sysbus->esp);
0

77 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c cfunc 366
static void sysbus_esp_gpio_demux(void *opaque, int irq, int level)
SysBusESPState *sysbus = ESP(opaque);
ESPState *s = &sysbus->esp;
parent_esp_reset(s, irq, level);
static void parent_esp_reset(ESPState *s, int irq, int level)
esp_soft_reset(s);
static void esp_soft_reset(ESPState *s)
esp_hard_reset(s);
void esp_hard_reset(ESPState *s)
memset(s->rregs, 0, ESP_REGS);
memset(s->wregs, 0, ESP_REGS);
static void sysbus_esp_hard_reset(DeviceState *dev)
SysBusESPState *sysbus = ESP(dev);
esp_hard_reset(&sysbus->esp);
static void sysbus_esp_mem_write(void *opaque, hwaddr addr,
esp_reg_write(&sysbus->esp, saddr, val);
void esp_reg_write(ESPState *s, uint32_t saddr, uint64_t val)
esp_soft_reset(s);
0

490 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c cfunc 688
static void sysbus_esp_realize(DeviceState *dev, Error **errp)
SysBusDevice *sbd = SYS_BUS_DEVICE(dev);
SysBusESPState *sysbus = ESP(dev);
assert(sysbus->it_shift != -1);
0

491 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c cppfunc 688
static void sysbus_esp_realize(DeviceState *dev, Error **errp)
SysBusDevice *sbd = SYS_BUS_DEVICE(dev);
SysBusESPState *sysbus = ESP(dev);
assert(sysbus->it_shift != -1);
0

658 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c cfunc 96
uint8_t buf[32];
len = get_cmd(s, buf);
uint8_t buf[32];
len = get_cmd(s, buf);
s->dma = 1;
s->dma = 0;
handle_satn(s);
static void sysbus_esp_mem_write(void *opaque, hwaddr addr,
esp_reg_write(&sysbus->esp, saddr, val);
void esp_reg_write(ESPState *s, uint32_t saddr, uint64_t val)
handle_satn_stop(s);
static void handle_satn_stop(ESPState *s)
s->cmdlen = get_cmd(s, s->cmdbuf);
static uint32_t get_cmd(ESPState *s, uint8_t *buf)
dmalen = s->ti_size;
memcpy(buf, s->ti_buf, dmalen);
static void handle_satn(ESPState *s)
len = get_cmd(s, buf);
1

13597 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 160
static void handle_satn(ESPState *s)
uint8_t buf[32];
len = get_cmd(s, buf);
static uint32_t get_cmd(ESPState *s, uint8_t *buf)
uint32_t dmalen;
dmalen = s->ti_size;
memcpy(buf, s->ti_buf, dmalen);
1

13598 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 600
static void sysbus_esp_mem_write(void *opaque, hwaddr addr,uint64_t val, unsigned int size)
SysBusESPState *sysbus = opaque;
uint32_t saddr;
saddr = addr >> sysbus->it_shift;
esp_reg_write(&sysbus->esp, saddr, val);
void esp_reg_write(ESPState *s, uint32_t saddr, uint64_t val)
handle_satn_stop(s);
static void handle_satn_stop(ESPState *s)
s->cmdlen = get_cmd(s, s->cmdbuf);
static uint32_t get_cmd(ESPState *s, uint8_t *buf)
uint32_t dmalen;
dmalen = s->ti_size;
memcpy(buf, s->ti_buf, dmalen);
1

13611 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 160
static void handle_satn(ESPState *s)
uint8_t buf[32];
len = get_cmd(s, buf, sizeof(buf));
static uint32_t get_cmd(ESPState *s, uint8_t *buf, uint8_t buflen)
uint32_t dmalen;
if (dmalen > buflen) {
return 0;
dmalen = s->ti_size;
memcpy(buf, s->ti_buf, dmalen);
0

13612 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 600
static void sysbus_esp_mem_write(void *opaque, hwaddr addr,
esp_reg_write(&sysbus->esp, saddr, val);
void esp_reg_write(ESPState *s, uint32_t saddr, uint64_t val)
handle_satn_stop(s);
static void handle_satn_stop(ESPState *s)
s->cmdlen = get_cmd(s, s->cmdbuf, sizeof(s->cmdbuf));
static uint32_t get_cmd(ESPState *s, uint8_t *buf, uint8_t buflen)
uint32_t dmalen;
if (dmalen > buflen) {
return 0;
dmalen = s->ti_size;
memcpy(buf, s->ti_buf, dmalen);
0

14031 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 160
static void handle_satn(ESPState *s)
uint8_t buf[32];
len = get_cmd(s, buf, sizeof(buf));
static uint32_t get_cmd(ESPState *s, uint8_t *buf, uint8_t buflen)
uint32_t dmalen;
if (dmalen > buflen) {
return 0;
dmalen = s->ti_size;
componet_len = dmalen;
memcpy(buf, s->ti_buf, componet_len);
0

14032 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 600
static void sysbus_esp_mem_write(void *opaque, hwaddr addr,
esp_reg_write(&sysbus->esp, saddr, val);
void esp_reg_write(ESPState *s, uint32_t saddr, uint64_t val)
handle_satn_stop(s);
static void handle_satn_stop(ESPState *s)
s->cmdlen = get_cmd(s, s->cmdbuf, sizeof(s->cmdbuf));
static uint32_t get_cmd(ESPState *s, uint8_t *buf, uint8_t buflen)
uint32_t dmalen;
if (dmalen > buflen) {
return 0;
dmalen = s->ti_size;
componet_len = dmalen;
memcpy(buf, s->ti_buf, componet_len);
0

14045 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 160
static void handle_satn(ESPState *s)
uint8_t buf[32];
len = get_cmd(s, buf);
static uint32_t get_cmd(ESPState *s, uint8_t *buf)
uint32_t dmalen;
dmalen = s->ti_size;
componet_len = dmalen;
memcpy(buf, s->ti_buf, componet_len);
1

14046 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 600
static void sysbus_esp_mem_write(void *opaque, hwaddr addr,uint64_t val, unsigned int size)
SysBusESPState *sysbus = opaque;
uint32_t saddr;
saddr = addr >> sysbus->it_shift;
esp_reg_write(&sysbus->esp, saddr, val);
void esp_reg_write(ESPState *s, uint32_t saddr, uint64_t val)
handle_satn_stop(s);
static void handle_satn_stop(ESPState *s)
s->cmdlen = get_cmd(s, s->cmdbuf);
static uint32_t get_cmd(ESPState *s, uint8_t *buf)
uint32_t dmalen;
dmalen = s->ti_size;
componet_len = dmalen;
memcpy(buf, s->ti_buf, componet_len);
1

14059 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 160
static void handle_satn(ESPState *s)
uint8_t buf[32];
len = get_cmd(s, buf, sizeof(buf));
static uint32_t get_cmd(ESPState *s, uint8_t *buf, uint8_t buflen)
uint32_t dmalen;
if (dmalen > buflen) {
return 0;
damlen = func(&s);
uint32_t func(ESPState **s)
return (*s)->ti_size;
damlen = func(&s);
memcpy(buf, s->ti_buf, dmalen);
0

14060 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 600
static void sysbus_esp_mem_write(void *opaque, hwaddr addr,
esp_reg_write(&sysbus->esp, saddr, val);
void esp_reg_write(ESPState *s, uint32_t saddr, uint64_t val)
handle_satn_stop(s);
static void handle_satn_stop(ESPState *s)
s->cmdlen = get_cmd(s, s->cmdbuf, sizeof(s->cmdbuf));
static uint32_t get_cmd(ESPState *s, uint8_t *buf, uint8_t buflen)
uint32_t dmalen;
if (dmalen > buflen) {
return 0;
damlen = func(&s);
uint32_t func(ESPState **s)
return (*s)->ti_size;
damlen = func(&s);
memcpy(buf, s->ti_buf, dmalen);
0

14073 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 160
static void handle_satn(ESPState *s)
uint8_t buf[32];
len = get_cmd(s, buf);
static uint32_t get_cmd(ESPState *s, uint8_t *buf)
uint32_t dmalen;
damlen = func(&s);
uint32_t func(ESPState **s)
return (*s)->ti_size;
damlen = func(&s);
memcpy(buf, s->ti_buf, dmalen);
1

14074 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 600
static void sysbus_esp_mem_write(void *opaque, hwaddr addr,uint64_t val, unsigned int size)
SysBusESPState *sysbus = opaque;
uint32_t saddr;
saddr = addr >> sysbus->it_shift;
esp_reg_write(&sysbus->esp, saddr, val);
void esp_reg_write(ESPState *s, uint32_t saddr, uint64_t val)
handle_satn_stop(s);
static void handle_satn_stop(ESPState *s)
s->cmdlen = get_cmd(s, s->cmdbuf);
static uint32_t get_cmd(ESPState *s, uint8_t *buf)
uint32_t dmalen;
damlen = func(&s);
uint32_t func(ESPState **s)
return (*s)->ti_size;
damlen = func(&s);
memcpy(buf, s->ti_buf, dmalen);
1

14087 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 160
static void handle_satn(ESPState *s)
uint8_t buf[32];
len = get_cmd(s, buf, sizeof(buf));
static uint32_t get_cmd(ESPState *s, uint8_t *buf, uint8_t buflen)
structType myStruct;
uint32_t dmalen;
if (dmalen > buflen) {
return 0;
myStruct.structFirst = s;
damlen = func(myStruct);
uint32_t func(structType myStruct)
ESPState s = myStruct.structFirst;
return s->ti_size;
damlen = func(myStruct);
memcpy(buf, s->ti_buf, dmalen);
0

14088 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 600
static void sysbus_esp_mem_write(void *opaque, hwaddr addr,
esp_reg_write(&sysbus->esp, saddr, val);
void esp_reg_write(ESPState *s, uint32_t saddr, uint64_t val)
handle_satn_stop(s);
static void handle_satn_stop(ESPState *s)
s->cmdlen = get_cmd(s, s->cmdbuf, sizeof(s->cmdbuf));
static uint32_t get_cmd(ESPState *s, uint8_t *buf, uint8_t buflen)
structType myStruct;
uint32_t dmalen;
if (dmalen > buflen) {
return 0;
myStruct.structFirst = s;
damlen = func(myStruct);
uint32_t func(structType myStruct)
ESPState s = myStruct.structFirst;
return s->ti_size;
damlen = func(myStruct);
memcpy(buf, s->ti_buf, dmalen);
0

14101 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 160
static void handle_satn(ESPState *s)
uint8_t buf[32];
len = get_cmd(s, buf);
static uint32_t get_cmd(ESPState *s, uint8_t *buf)
structType myStruct;
uint32_t dmalen;
myStruct.structFirst = s;
damlen = func(myStruct);
uint32_t func(structType myStruct)
ESPState s = myStruct.structFirst;
return s->ti_size;
damlen = func(myStruct);
memcpy(buf, s->ti_buf, dmalen);
1

14102 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 600
static void sysbus_esp_mem_write(void *opaque, hwaddr addr,uint64_t val, unsigned int size)
SysBusESPState *sysbus = opaque;
uint32_t saddr;
saddr = addr >> sysbus->it_shift;
esp_reg_write(&sysbus->esp, saddr, val);
void esp_reg_write(ESPState *s, uint32_t saddr, uint64_t val)
handle_satn_stop(s);
static void handle_satn_stop(ESPState *s)
s->cmdlen = get_cmd(s, s->cmdbuf);
static uint32_t get_cmd(ESPState *s, uint8_t *buf)
structType myStruct;
uint32_t dmalen;
myStruct.structFirst = s;
damlen = func(myStruct);
uint32_t func(structType myStruct)
ESPState s = myStruct.structFirst;
return s->ti_size;
damlen = func(myStruct);
memcpy(buf, s->ti_buf, dmalen);
1

14115 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 160
static void handle_satn(ESPState *s)
uint8_t buf[32];
len = get_cmd(s, buf, sizeof(buf));
static uint32_t get_cmd(ESPState *s, uint8_t *buf, uint8_t buflen)
unionType myUnion;
uint32_t dmalen;
if (dmalen > buflen) {
return 0;
damlen = func(myUnion);
uint32_t func(unionType myUnion)
ESPState *s = myUnion.unionSecond;
return s->ti_size;
dmalen = func(myUnion)
memcpy(buf, s->ti_buf, dmalen);
0

14116 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 600
static void sysbus_esp_mem_write(void *opaque, hwaddr addr,
esp_reg_write(&sysbus->esp, saddr, val);
void esp_reg_write(ESPState *s, uint32_t saddr, uint64_t val)
handle_satn_stop(s);
static void handle_satn_stop(ESPState *s)
s->cmdlen = get_cmd(s, s->cmdbuf, sizeof(s->cmdbuf));
static uint32_t get_cmd(ESPState *s, uint8_t *buf, uint8_t buflen)
unionType myUnion;
uint32_t dmalen;
if (dmalen > buflen) {
return 0;
myUnion.unionFirst = s;
damlen = func(myUnion);
uint32_t func(unionType myUnion)
ESPState *s = myUnion.unionSecond;
return s->ti_size;
damlen = func(myUnion);
memcpy(buf, s->ti_buf, dmalen);
0

14129 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 160
static void handle_satn(ESPState *s)
uint8_t buf[32];
len = get_cmd(s, buf);
static uint32_t get_cmd(ESPState *s, uint8_t *buf)
unionType myUnion;
uint32_t dmalen;
damlen = func(myUnion);
uint32_t func(unionType myUnion)
ESPState *s = myUnion.unionSecond;
return s->ti_size;
dmalen = func(myUnion);
memcpy(buf, s->ti_buf, dmalen);
1

14130 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 600
static void sysbus_esp_mem_write(void *opaque, hwaddr addr,uint64_t val, unsigned int size)
SysBusESPState *sysbus = opaque;
uint32_t saddr;
saddr = addr >> sysbus->it_shift;
esp_reg_write(&sysbus->esp, saddr, val);
void esp_reg_write(ESPState *s, uint32_t saddr, uint64_t val)
handle_satn_stop(s);
static void handle_satn_stop(ESPState *s)
s->cmdlen = get_cmd(s, s->cmdbuf);
static uint32_t get_cmd(ESPState *s, uint8_t *buf)
unionType myUnion;
uint32_t dmalen;
myUnion.unionFirst = s;
damlen = func(myUnion);
uint32_t func(unionType myUnion)
ESPState *s = myUnion.unionSecond;
return s->ti_size;
damlen = func(myUnion);
memcpy(buf, s->ti_buf, dmalen);
1

14143 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 160
static void handle_satn(ESPState *s)
uint8_t buf[32];
len = get_cmd(s, buf, sizeof(buf));
static uint32_t get_cmd(ESPState *s, uint8_t *buf, uint8_t buflen)
uint32_t dmalen;
if (dmalen > buflen) {
return 0;
damlen = func(s);
uint32_t func(ESPState *s)
return s->ti_size;
damlen = func(s);
memcpy(buf, s->ti_buf, dmalen);
0

14144 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 600
static void sysbus_esp_mem_write(void *opaque, hwaddr addr,
esp_reg_write(&sysbus->esp, saddr, val);
void esp_reg_write(ESPState *s, uint32_t saddr, uint64_t val)
handle_satn_stop(s);
static void handle_satn_stop(ESPState *s)
s->cmdlen = get_cmd(s, s->cmdbuf, sizeof(s->cmdbuf));
static uint32_t get_cmd(ESPState *s, uint8_t *buf, uint8_t buflen)
uint32_t dmalen;
if (dmalen > buflen) {
return 0;
damlen = func(s);
uint32_t func(ESPState *s)
return s->ti_size;
damlen = func(s);
memcpy(buf, s->ti_buf, dmalen);
0

14157 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 160
uint32_t (*funcPtr)(ESPState *) = badSource;
static void handle_satn(ESPState *s)
uint8_t buf[32];
len = get_cmd(s, buf);
static uint32_t get_cmd(ESPState *s, uint8_t *buf)
uint32_t dmalen;
damlen = funcPtr(s);
uint32_t badSource(ESPState *s)
return s->ti_size;
damlen = funcPtr(s);
memcpy(buf, s->ti_buf, dmalen);
1

14158 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 600
uint32_t (*funcPtr)(ESPState *) = badSource;
static void sysbus_esp_mem_write(void *opaque, hwaddr addr,uint64_t val, unsigned int size)
SysBusESPState *sysbus = opaque;
uint32_t saddr;
saddr = addr >> sysbus->it_shift;
esp_reg_write(&sysbus->esp, saddr, val);
void esp_reg_write(ESPState *s, uint32_t saddr, uint64_t val)
handle_satn_stop(s);
static void handle_satn_stop(ESPState *s)
s->cmdlen = get_cmd(s, s->cmdbuf);
static uint32_t get_cmd(ESPState *s, uint8_t *buf)
uint32_t dmalen;
damlen = funcPtr(s);
uint32_t badSource(ESPState *s)
return s->ti_size;
damlen = funcPtr(s);
memcpy(buf, s->ti_buf, dmalen);
1

14171 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 160
static void handle_satn(ESPState *s)
uint8_t buf[32];
len = get_cmd(s, buf, sizeof(buf));
static uint32_t get_cmd(ESPState *s, uint8_t *buf, uint8_t buflen)
uint32_t dmalen;
if (dmalen > buflen) {
return 0;
dmalen = func(s);
uint32_t func(ESPState *s)
return s->ti_size;
dmalen = func(s);
memcpy(buf, s->ti_buf, dmalen);
0

14172 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 600
static void sysbus_esp_mem_write(void *opaque, hwaddr addr,
esp_reg_write(&sysbus->esp, saddr, val);
void esp_reg_write(ESPState *s, uint32_t saddr, uint64_t val)
handle_satn_stop(s);
static void handle_satn_stop(ESPState *s)
s->cmdlen = get_cmd(s, s->cmdbuf, sizeof(s->cmdbuf));
static uint32_t get_cmd(ESPState *s, uint8_t *buf, uint8_t buflen)
uint32_t dmalen;
if (dmalen > buflen) {
return 0;
dmalen = func(s);
uint32_t func(ESPState *s)
return s->ti_size;
dmalen = func(s);
memcpy(buf, s->ti_buf, dmalen);
0

14185 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 160
static void handle_satn(ESPState *s)
uint8_t buf[32];
len = get_cmd(s, buf);
static uint32_t get_cmd(ESPState *s, uint8_t *buf)
uint32_t dmalen;
damlen = func(s);
uint32_t func(ESPState *s)
return s->ti_size;
damlen = func(s);
memcpy(buf, s->ti_buf, dmalen);
1

14186 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 600
static void sysbus_esp_mem_write(void *opaque, hwaddr addr,uint64_t val, unsigned int size)
SysBusESPState *sysbus = opaque;
uint32_t saddr;
saddr = addr >> sysbus->it_shift;
esp_reg_write(&sysbus->esp, saddr, val);
void esp_reg_write(ESPState *s, uint32_t saddr, uint64_t val)
handle_satn_stop(s);
static void handle_satn_stop(ESPState *s)
s->cmdlen = get_cmd(s, s->cmdbuf);
static uint32_t get_cmd(ESPState *s, uint8_t *buf)
uint32_t dmalen;
damlen = func(s);
uint32_t func(ESPState *s)
return s->ti_size;
damlen = func(s);
memcpy(buf, s->ti_buf, dmalen);
1

14199 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 160
static void handle_satn(ESPState *s)
uint8_t buf[32];
len = get_cmd(s, buf, sizeof(buf));
static uint32_t get_cmd(ESPState *s, uint8_t *buf, uint8_t buflen)
uint32_t dmalen;
if (dmalen > buflen) {
return 0;
uint32_t *dataCopy = &s->ti_size;
dmalen = *dataCopy;
memcpy(buf, s->ti_buf, dmalen);
0

14200 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 600
static void sysbus_esp_mem_write(void *opaque, hwaddr addr,
esp_reg_write(&sysbus->esp, saddr, val);
void esp_reg_write(ESPState *s, uint32_t saddr, uint64_t val)
handle_satn_stop(s);
static void handle_satn_stop(ESPState *s)
s->cmdlen = get_cmd(s, s->cmdbuf, sizeof(s->cmdbuf));
static uint32_t get_cmd(ESPState *s, uint8_t *buf, uint8_t buflen)
uint32_t dmalen;
ESPState *dataCopy = s;
s = dataCopy;
if (dmalen > buflen) {
return 0;
dmalen = s->ti_size;
memcpy(buf, s->ti_buf, dmalen);
0

14213 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 160
static void handle_satn(ESPState *s)
uint8_t buf[32];
len = get_cmd(s, buf);
static uint32_t get_cmd(ESPState *s, uint8_t *buf)
uint32_t dmalen;
uint32_t *dataCopy = &s->ti_size;
dmalen = *dataCopy;
memcpy(buf, s->ti_buf, dmalen);
1

14214 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 600
static void sysbus_esp_mem_write(void *opaque, hwaddr addr,uint64_t val, unsigned int size)
SysBusESPState *sysbus = opaque;
uint32_t saddr;
saddr = addr >> sysbus->it_shift;
esp_reg_write(&sysbus->esp, saddr, val);
void esp_reg_write(ESPState *s, uint32_t saddr, uint64_t val)
handle_satn_stop(s);
static void handle_satn_stop(ESPState *s)
s->cmdlen = get_cmd(s, s->cmdbuf);
static uint32_t get_cmd(ESPState *s, uint8_t *buf)
uint32_t dmalen;
ESPState *dataCopy = s;
s = dataCopy;
dmalen = s->ti_size;
memcpy(buf, s->ti_buf, dmalen);
1

14227 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 160
static void handle_satn(ESPState *s)
uint8_t buf[32];
ESPState *dataArray[5];
len = get_cmd(s, buf, sizeof(buf));
static uint32_t get_cmd(ESPState *s, uint8_t *buf, uint8_t buflen)
uint32_t dmalen;
if (dmalen > buflen) {
return 0;
dataArray[2] = s;
damlen = func(dataArray);
uint32_t func(ESPState *dataArray[])
ESPState *s = dataArray[2];
return s->ti_size;
damlen = func(dataArray);
memcpy(buf, s->ti_buf, dmalen);
0

14228 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 600
static void sysbus_esp_mem_write(void *opaque, hwaddr addr,
esp_reg_write(&sysbus->esp, saddr, val);
void esp_reg_write(ESPState *s, uint32_t saddr, uint64_t val)
handle_satn_stop(s);
static void handle_satn_stop(ESPState *s)
s->cmdlen = get_cmd(s, s->cmdbuf, sizeof(s->cmdbuf));
static uint32_t get_cmd(ESPState *s, uint8_t *buf, uint8_t buflen)
ESPState *dataArray[5];
uint32_t dmalen;
if (dmalen > buflen) {
return 0;
dataArray[2] = s;
damlen = func(dataArray);
uint32_t func(ESPState *dataArray[])
ESPState *s = dataArray[2];
return s->ti_size;
damlen = func(dataArray);
memcpy(buf, s->ti_buf, dmalen);
0

14241 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 160
static void handle_satn(ESPState *s)
uint8_t buf[32];
ESPState *dataArray[5];
len = get_cmd(s, buf);
static uint32_t get_cmd(ESPState *s, uint8_t *buf)
uint32_t dmalen;
dataArray[2] = s;
damlen = func(dataArray);
uint32_t func(ESPState *dataArray[])
ESPState *s = dataArray[2];
return s->ti_size;
damlen = func(dataArray);
memcpy(buf, s->ti_buf, dmalen);
1

14242 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 600
static void sysbus_esp_mem_write(void *opaque, hwaddr addr,uint64_t val, unsigned int size)
SysBusESPState *sysbus = opaque;
uint32_t saddr;
saddr = addr >> sysbus->it_shift;
esp_reg_write(&sysbus->esp, saddr, val);
void esp_reg_write(ESPState *s, uint32_t saddr, uint64_t val)
handle_satn_stop(s);
static void handle_satn_stop(ESPState *s)
s->cmdlen = get_cmd(s, s->cmdbuf);
static uint32_t get_cmd(ESPState *s, uint8_t *buf)
ESPState *dataArray[5];
uint32_t dmalen;
dataArray[2] = s;
damlen = func(dataArray);
uint32_t func(ESPState *dataArray[])
ESPState *s = dataArray[2];
return s->ti_size;
damlen = func(dataArray);
memcpy(buf, s->ti_buf, dmalen);
1

14260 CVE-2016-4441/qemu_2.3.0_CVE-2016-4441_esp.c Buffer_Overflow_boundedcpy 600
static void sysbus_esp_mem_write(void *opaque, hwaddr addr,uint64_t val, unsigned int size)
uint32_t saddr;
SysBusESPState *sysbus = opaque;
saddr = addr >> sysbus->it_shift;
esp_reg_write(&sysbus->esp, saddr, val);
void esp_reg_write(ESPState *s, uint32_t saddr, uint64_t val)
handle_satn_stop(s);
static void handle_satn_stop(ESPState *s)
s->cmdlen = get_cmd(s, s->cmdbuf);
static uint32_t get_cmd(ESPState *s, uint8_t *buf)
uint32_t dmalen;
dmalen = s->ti_size;
memcpy(buf, s->ti_buf, dmalen);
1

