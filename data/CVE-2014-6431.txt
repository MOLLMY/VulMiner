60 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c cfunc 934
process_rec_header2_v2(wtap *wth, unsigned char *buffer, guint16 length,
static const char x_25_str[] = "HDLC\nX.25\n";
if (length < sizeof x_25_str - 1) {
if (strncmp((char *)buffer, x_25_str, sizeof x_25_str - 1) == 0) {
0

374 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c cfunc 775
struct vers_rec version;
struct tm tm;
bytes_read = file_read(&version, sizeof version, wth->fh);
if (bytes_read != sizeof version) {
start_date = pletoh16(&version.date);
tm.tm_year = ((start_date&DOS_YEAR_MASK)>>DOS_YEAR_SHIFT) + DOS_YEAR_OFFSET;
tm.tm_mon = ((start_date&DOS_MONTH_MASK)>>DOS_MONTH_SHIFT) + DOS_MONTH_OFFSET;
tm.tm_mday = ((start_date&DOS_DAY_MASK)>>DOS_DAY_SHIFT);
tm.tm_hour = 0;
tm.tm_min = 0;
tm.tm_sec = 0;
tm.tm_isdst = -1;
ngsniffer->start = mktime(&tm);
0

375 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c cppfunc 775
struct vers_rec version;
struct tm tm;
bytes_read = file_read(&version, sizeof version, wth->fh);
if (bytes_read != sizeof version) {
start_date = pletoh16(&version.date);
tm.tm_year = ((start_date&DOS_YEAR_MASK)>>DOS_YEAR_SHIFT) + DOS_YEAR_OFFSET;
tm.tm_mon = ((start_date&DOS_MONTH_MASK)>>DOS_MONTH_SHIFT) + DOS_MONTH_OFFSET;
tm.tm_mday = ((start_date&DOS_DAY_MASK)>>DOS_DAY_SHIFT);
tm.tm_hour = 0;
tm.tm_min = 0;
tm.tm_sec = 0;
tm.tm_isdst = -1;
ngsniffer->start = mktime(&tm);
0

392 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c cfunc 2527
static int read_blob(FILE_T infile, ngsniffer_comp_stream_t *comp_stream,
comp_stream = &ngsniffer->rand;
comp_stream = &ngsniffer->seq;
if (read_blob(infile, comp_stream, err, err_info) < 0)
bytes_left = comp_stream->nbytes - comp_stream->nextout;
if (read_blob(infile, comp_stream, err, err_info) < 0)
bytes_left = comp_stream->nbytes - comp_stream->nextout;
bytes_to_copy = bytes_left;
memcpy(outbuffer, &comp_stream->buf[comp_stream->nextout],
bytes_to_copy);
copybytes -= bytes_to_copy;
bytes_to_copy = copybytes;
bytes_to_copy);
outbuffer += bytes_to_copy;
memcpy(outbuffer, &comp_stream->buf[comp_stream->nextout],
static int read_blob(FILE_T infile, ngsniffer_comp_stream_t *comp_stream,
if (read_blob(infile, comp_stream, err, err_info) < 0)
memcpy(outbuffer, &comp_stream->buf[comp_stream->nextout],
ng_file_read(void *buffer, unsigned int nbytes, wtap *wth, gboolean is_random,
unsigned int copybytes = nbytes;
unsigned char *outbuffer = (unsigned char *)buffer;
comp_stream = &ngsniffer->rand;
comp_stream->buf = (unsigned char *)g_malloc(OUTBUF_SIZE);
if (read_blob(infile, comp_stream, err, err_info) < 0)
if (read_blob(infile, comp_stream, err, err_info) < 0)
bytes_to_copy = copybytes;
memcpy(outbuffer, &comp_stream->buf[comp_stream->nextout],
bytes_to_copy);
outbuffer += bytes_to_copy;
memcpy(outbuffer, &comp_stream->buf[comp_stream->nextout],
comp_stream->nextout += bytes_to_copy;
bytes_left = comp_stream->nbytes - comp_stream->nextout;
bytes_to_copy = bytes_left;
bytes_to_copy);
outbuffer += bytes_to_copy;
memcpy(outbuffer, &comp_stream->buf[comp_stream->nextout],
0

441 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c cfunc 587
char magic[sizeof ngsniffer_magic];
bytes_read = file_read(magic, sizeof magic, wth->fh);
if (bytes_read != sizeof magic) {
if (memcmp(magic, ngsniffer_magic, sizeof ngsniffer_magic)) {
0

513 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c cfunc 2585
unsigned short blob_len;
read_len = file_read(&blob_len, 2, infile);
blob_len_host = pletoh16(&blob_len);
in_len = -blob_len_host;
in_len = blob_len_host;
file_inbuf = (unsigned char *)g_malloc(INBUF_SIZE);
read_len = file_read(file_inbuf, in_len, infile);
memcpy(comp_stream->buf, file_inbuf, in_len);
0

600 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c cfunc 2328
SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf,
unsigned char * pin  = inbuf;
unsigned char * pout = outbuf;
bit_value = pletoh16(pin);
pin += 2;
*(pout++) = *(pin++);
bit_value = pletoh16(pin);
code_type = (unsigned int) ((*pin) >> 4 ) & 0xF;
code_low  = (unsigned int) ((*pin) & 0xF );
pin++;
code_low  = (unsigned int) ((*pin) & 0xF );
length = code_low + 3;
memset( pout, *pin++, length );
bit_value = pletoh16(pin);
*(pout++) = *(pin++);
code_low  = (unsigned int) ((*pin) & 0xF );
pout += length;
length = code_low + ((unsigned int)(*pin++) << 4) + 19;
memset( pout, *pin++, length );
bit_value = pletoh16(pin);
*(pout++) = *(pin++);
code_low  = (unsigned int) ((*pin) & 0xF );
length = code_low + ((unsigned int)(*pin++) << 4) + 19;
memset( pout, *pin++, length );
pout += length;
memset( pout, *pin++, length );
offset = code_low + ((unsigned int)(*pin++) << 4) + 3;
length = (unsigned int)(*pin++) + 16;
bit_value = pletoh16(pin);
*(pout++) = *(pin++);
pin++;
pin += 2;
*(pout++) = *(pin++);
code_low  = (unsigned int) ((*pin) & 0xF );
length = code_low + ((unsigned int)(*pin++) << 4) + 19;
memset( pout, *pin++, length );
memcpy( pout, pout - offset, length );
memset( pout, *pin++, length );
pout += length;
memset( pout, *pin++, length );
offset = code_low + ((unsigned int)(*pin++) << 4) + 3;
length = code_type;
memcpy( pout, pout - offset, length );
memset( pout, *pin++, length );
pout += length;
memset( pout, *pin++, length );
1

628 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c cfunc 2364
SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf,
unsigned char * pin  = inbuf;
unsigned char * pout = outbuf;
bit_value = pletoh16(pin);
pin += 2;
*(pout++) = *(pin++);
code_type = (unsigned int) ((*pin) >> 4 ) & 0xF;
pin++;
memset( pout, *pin++, length );
memset( pout, *pin++, length );
length = (unsigned int)(*pin++) + 16;
bit_value = pletoh16(pin);
pin += 2;
*(pout++) = *(pin++);
code_low  = (unsigned int) ((*pin) & 0xF );
pin++;
length = code_low + 3;
memset( pout, *pin++, length );
pout += length;
length = code_low + ((unsigned int)(*pin++) << 4) + 19;
memset( pout, *pin++, length );
pout += length;
offset = code_low + ((unsigned int)(*pin++) << 4) + 3;
length = (unsigned int)(*pin++) + 16;
memcpy( pout, pout - offset, length );
pout += length;
memcpy( pout, pout - offset, length );
offset = code_low + ((unsigned int)(*pin++) << 4) + 3;
length = code_type;
memcpy( pout, pout - offset, length );
memcpy( pout, pout - offset, length );
pout += length;
memcpy( pout, pout - offset, length );
1

13108 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2301
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf,
size_t outlen, int *err)
unsigned char * pin  = inbuf;
unsigned char * pout = outbuf;
if ( pin + 2 >= pin_end ) {
*err = WTAP_ERR_UNC_TRUNCATED;
return ( -1 );                        }
bit_mask  = 0x8000;
bit_value = pletoh16(pin);
pin += 2;
if ( !(bit_mask & bit_value) )
if ( pout + 1 > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );
*(pout++) = *(pin++);
*(pout++) = *(pin++);
code_type = (unsigned int) ((*pin) >> 4 ) & 0xF;
code_low  = (unsigned int) ((*pin) & 0xF );
pin++;
bit_value = pletoh16(pin);
*(pout++) = *(pin++);
length = code_low + 3;
memset( pout, *pin++, length );
0

13109 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2393
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf, size_t outlen, int *err)
unsigned char * pout = outbuf;
int length;
int offset;
if ( !(bit_mask & bit_value) ){
if ( pout + 1 > pout_end )
{*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );                       }
*(pout++) = *(pin++);
offset = code_low + ((unsigned int)(*pin++) << 4) + 3;
if ( pout - offset + length > pout )
*err = WTAP_ERR_UNC_BAD_OFFSET;
return ( -1 );}
length = code_type;
if ( pout + length > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );}
memcpy( pout, pout - offset, length );
0

13146 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2301
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf,
size_t outlen, int *err)
unsigned char * pin  = inbuf;
unsigned char * pout = outbuf;
if ( 0 == bit_mask )              {
bit_mask  = 0x8000;
bit_value = pletoh16(pin);
pin += 2;
if ( !(bit_mask & bit_value) ){
*(pout++) = *(pin++);}
*(pout++) = *(pin++);
code_type = (unsigned int) ((*pin) >> 4 ) & 0xF;
code_low  = (unsigned int) ((*pin) & 0xF );
pin++;
bit_value = pletoh16(pin);
*(pout++) = *(pin++);
length = code_low + 3;
memset( pout, *pin++, length );
1

13147 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2393
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf, size_t outlen, int *err)
unsigned char * pout = outbuf;
int length;
int offset;
if ( !(bit_mask & bit_value) )
*(pout++) = *(pin++);		}
offset = code_low + ((unsigned int)(*pin++) << 4) + 3;
if ( pout - offset < outbuf )
*err = WTAP_ERR_UNC_BAD_OFFSET;
return ( -1 );}
length = code_type;
if ( pout + length > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );}
memcpy( pout, pout - offset, length );
1

13183 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2301
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf,
size_t outlen, int *err)
unsigned char * pin  = inbuf;
unsigned char * pout = outbuf;
if ( pin + 2 >= pin_end ) {
*err = WTAP_ERR_UNC_TRUNCATED;
return ( -1 );                        }
bit_mask  = 0x8000;
bit_value = pletoh16(pin);
pin += 2;
if ( !(bit_mask & bit_value) )
if ( pout + 1 > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );
*(pout++) = *(pin++);
*(pout++) = *(pin++);
code_type = (unsigned int) ((*pin) >> 4 ) & 0xF;
code_low  = (unsigned int) ((*pin) & 0xF );
pin++;
bit_value = pletoh16(pin);
*(pout++) = *(pin++);
component_data = code_low + 3;
length = component_data;
memset( pout, *pin++, component_data );
0

13184 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2393
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf, size_t outlen, int *err)
unsigned char * pout = outbuf;
int length;
int offset;
if ( !(bit_mask & bit_value) ){
if ( pout + 1 > pout_end )
{*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );                       }
*(pout++) = *(pin++);
offset = code_low + ((unsigned int)(*pin++) << 4) + 3;
if ( pout - offset + length > pout )
*err = WTAP_ERR_UNC_BAD_OFFSET;
return ( -1 );}
length = code_type;
if ( pout + length > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );}
component_data = pout - offset;
memcpy( pout, component_data, length );
0

13220 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2301
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf,
size_t outlen, int *err)
unsigned char * pin  = inbuf;
unsigned char * pout = outbuf;
if ( 0 == bit_mask )              {
bit_mask  = 0x8000;
bit_value = pletoh16(pin);
pin += 2;
if ( !(bit_mask & bit_value) ){
*(pout++) = *(pin++);}
*(pout++) = *(pin++);
code_type = (unsigned int) ((*pin) >> 4 ) & 0xF;
code_low  = (unsigned int) ((*pin) & 0xF );
pin++;
bit_value = pletoh16(pin);
*(pout++) = *(pin++);
component_data = code_low + 3;
length = component_data;
memset( pout, *pin++, component_data );
1

13221 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2393
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf, size_t outlen, int *err)
unsigned char * pout = outbuf;
int length;
int offset;
if ( !(bit_mask & bit_value) )
*(pout++) = *(pin++);		}
offset = code_low + ((unsigned int)(*pin++) << 4) + 3;
if ( pout - offset < outbuf )
*err = WTAP_ERR_UNC_BAD_OFFSET;
return ( -1 );}
length = code_type;
if ( pout + length > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );}
component_data = pout - offset;
memcpy( pout, component, length );
1

13239 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2301
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf,
size_t outlen, int *err)
unsigned char * pin  = inbuf;
unsigned char * pout = outbuf;
if ( 0 == bit_mask )              {
bit_mask  = 0x8000;
bit_value = pletoh16(pin);
pin += 2;
if ( !(bit_mask & bit_value) ){
*(pout++) = *(pin++);}
*(pout++) = *(pin++);
code_type = (unsigned int) ((*pin) >> 4 ) & 0xF;
code_low  = (unsigned int) ((*pin) & 0xF );
pin++;
bit_value = pletoh16(pin);
*(pout++) = *(pin++);
length = func(&code_low);
unsigned func(unsigned int *code_low)
return *code_low + 3;
length = func(&code_low);
memset( pout, *pin++, length );
1

13240 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2393
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf, size_t outlen, int *err)
unsigned char * pout = outbuf;
int length;
int offset;
if ( !(bit_mask & bit_value) )
*(pout++) = *(pin++);		}
offset = code_low + ((unsigned int)(*pin++) << 4) + 3;
if ( pout - offset < outbuf )
*err = WTAP_ERR_UNC_BAD_OFFSET;
return ( -1 );}
length = func(&code_type);
int func(int *code_type)
return *code_type;
length = func(&code_type);
if ( pout + length > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );}
memcpy( pout, pout - offset, length );
1

13258 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2301
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf,
size_t outlen, int *err)
unsigned char * pin  = inbuf;
unsigned char * pout = outbuf;
if ( pin + 2 >= pin_end ) {
*err = WTAP_ERR_UNC_TRUNCATED;
return ( -1 );                        }
bit_mask  = 0x8000;
bit_value = pletoh16(pin);
pin += 2;
if ( !(bit_mask & bit_value) )
if ( pout + 1 > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );
*(pout++) = *(pin++);
*(pout++) = *(pin++);
code_type = (unsigned int) ((*pin) >> 4 ) & 0xF;
code_low  = (unsigned int) ((*pin) & 0xF );
pin++;
bit_value = pletoh16(pin);
*(pout++) = *(pin++);
length = func(&code_low);
unsigned func(unsigned int *code_low)
return *code_low + 3;
length = func(&code_low);
memset( pout, *pin++, length );
0

13259 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2393
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf, size_t outlen, int *err)
unsigned char * pout = outbuf;
int length;
int offset;
if ( !(bit_mask & bit_value) ){
if ( pout + 1 > pout_end )
{*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );                       }
*(pout++) = *(pin++);
offset = code_low + ((unsigned int)(*pin++) << 4) + 3;
if ( pout - offset + length > pout )
*err = WTAP_ERR_UNC_BAD_OFFSET;
return ( -1 );}
length = func(&code_type);
int func(int *code_type)
return *code_type;
length = func(&code_type);
if ( pout + length > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );}
memcpy( pout, pout - offset, length );
0

13276 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2301
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf,
size_t outlen, int *err)
unsigned char * pin  = inbuf;
unsigned char * pout = outbuf;
if ( pin + 2 >= pin_end ) {
*err = WTAP_ERR_UNC_TRUNCATED;
return ( -1 );                        }
bit_mask  = 0x8000;
bit_value = pletoh16(pin);
pin += 2;
if ( !(bit_mask & bit_value) )
if ( pout + 1 > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );
*(pout++) = *(pin++);
*(pout++) = *(pin++);
code_type = (unsigned int) ((*pin) >> 4 ) & 0xF;
code_low  = (unsigned int) ((*pin) & 0xF );
pin++;
bit_value = pletoh16(pin);
*(pout++) = *(pin++);
unsigned int dataArray[5];
dataArray[2] = code_low;
length = goodSource(dataArray);
unsigned int goodSource(dataArray)
unsigned int code_low = dataArray[2];
return code_low + 3;
length = goodSource(dataArray);
memset( pout, *pin++, length );
0

13277 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2393
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf, size_t outlen, int *err)
unsigned char * pout = outbuf;
int length;
int offset;
if ( !(bit_mask & bit_value) ){
if ( pout + 1 > pout_end )
{*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );                       }
*(pout++) = *(pin++);
offset = code_low + ((unsigned int)(*pin++) << 4) + 3;
if ( pout - offset + length > pout ){
*err = WTAP_ERR_UNC_BAD_OFFSET;
return ( -1 );}
int dataArray[5];
dataArray[2] = code_type;
length = goodSource(dataArray);
int goodSource(int dataArray[5])
int code_type = dataArray[2];
return code_type;
length = goodSource(dataArray);
if ( pout + length > pout_end ){
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );}
memcpy( pout, pout - offset, length );
0

13294 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2301
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf,
size_t outlen, int *err)
unsigned char * pin  = inbuf;
unsigned char * pout = outbuf;
if ( 0 == bit_mask )              {
bit_mask  = 0x8000;
bit_value = pletoh16(pin);
pin += 2;
if ( !(bit_mask & bit_value) ){
*(pout++) = *(pin++);}
*(pout++) = *(pin++);
code_type = (unsigned int) ((*pin) >> 4 ) & 0xF;
code_low  = (unsigned int) ((*pin) & 0xF );
pin++;
bit_value = pletoh16(pin);
*(pout++) = *(pin++);
unsigned int dataArray[5];
dataArray[2] = code_low;
length = badSource(dataArray);
unsigned int badSource(dataArray)
unsigned int code_low = dataArray[2];
return code_low + 3;
length = badSource(dataArray);
memset( pout, *pin++, length );
1

13295 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2393
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf, size_t outlen, int *err)
unsigned char * pout = outbuf;
int length;
int offset;
if ( !(bit_mask & bit_value) )
*(pout++) = *(pin++);		}
offset = code_low + ((unsigned int)(*pin++) << 4) + 3;
if ( pout - offset < outbuf )
*err = WTAP_ERR_UNC_BAD_OFFSET;
return ( -1 );}
int dataArray[5];
dataArray[2] = code_type;
length = badSource(dataArray);
int badSource(int dataArray[5])
int code_type = dataArray[2];
return code_type;
length = badSource(dataArray);
if ( pout + length > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );}
memcpy( pout, pout - offset, length );
1

13320 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2301
unsigned (*funcPtr)(unsigned int ) = goodSource;
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf,
size_t outlen, int *err)
unsigned char * pin  = inbuf;
unsigned char * pout = outbuf;
if ( pin + 2 >= pin_end ) {
*err = WTAP_ERR_UNC_TRUNCATED;
return ( -1 );                        }
bit_mask  = 0x8000;
bit_value = pletoh16(pin);
pin += 2;
if ( !(bit_mask & bit_value) )
if ( pout + 1 > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );
*(pout++) = *(pin++);
*(pout++) = *(pin++);
code_type = (unsigned int) ((*pin) >> 4 ) & 0xF;
code_low  = (unsigned int) ((*pin) & 0xF );
pin++;
bit_value = pletoh16(pin);
*(pout++) = *(pin++);
length = funcPtr(code_low);
unsigned goodSource(unsigned int code_low)
return code_low + 3;
length = funcPtr(code_low);
memset( pout, *pin++, length );
0

13321 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2393
int (*funcPtr)(int ) = goodSource;
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf, size_t outlen, int *err)
unsigned char * pout = outbuf;
int length;
int offset;
if ( !(bit_mask & bit_value) ){
if ( pout + 1 > pout_end )
{*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );                       }
*(pout++) = *(pin++);
offset = code_low + ((unsigned int)(*pin++) << 4) + 3;
if ( pout - offset + length > pout )
*err = WTAP_ERR_UNC_BAD_OFFSET;
return ( -1 );}
length = funcPtr(code_type);
int goodSource(int code_type)
return code_type;
length = funcPtr(code_type);
if ( pout + length > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );}
memcpy( pout, pout - offset, length );
0

13346 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2301
unsigned (*funcPtr)(unsigned int ) = badSource;
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf,
size_t outlen, int *err)
unsigned char * pin  = inbuf;
unsigned char * pout = outbuf;
if ( 0 == bit_mask )              {
bit_mask  = 0x8000;
bit_value = pletoh16(pin);
pin += 2;
if ( !(bit_mask & bit_value) ){
*(pout++) = *(pin++);}
*(pout++) = *(pin++);
code_type = (unsigned int) ((*pin) >> 4 ) & 0xF;
code_low  = (unsigned int) ((*pin) & 0xF );
pin++;
bit_value = pletoh16(pin);
*(pout++) = *(pin++);
length = funcPtr(code_low);
unsigned badSource(unsigned int code_low)
return code_low + 3;
length = funcPtr(code_low);
memset( pout, *pin++, length );
1

13347 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2393
int (*funcPtr)(int ) = badSource;
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf, size_t outlen, int *err)
unsigned char * pout = outbuf;
int length;
int offset;
if ( !(bit_mask & bit_value) )
*(pout++) = *(pin++);		}
offset = code_low + ((unsigned int)(*pin++) << 4) + 3;
if ( pout - offset < outbuf )
*err = WTAP_ERR_UNC_BAD_OFFSET;
return ( -1 );}
length = funcPtr(code_type);
int badSource(int code_type)
return code_type;
length = funcPtr(code_type);
if ( pout + length > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );}
memcpy( pout, pout - offset, length );
1

13372 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2301
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf,
size_t outlen, int *err)
unsigned char * pin  = inbuf;
unsigned char * pout = outbuf;
if ( pin + 2 >= pin_end ) {
*err = WTAP_ERR_UNC_TRUNCATED;
return ( -1 );                        }
bit_mask  = 0x8000;
bit_value = pletoh16(pin);
pin += 2;
if ( !(bit_mask & bit_value) )
if ( pout + 1 > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );
*(pout++) = *(pin++);
*(pout++) = *(pin++);
code_type = (unsigned int) ((*pin) >> 4 ) & 0xF;
code_low  = (unsigned int) ((*pin) & 0xF );
pin++;
bit_value = pletoh16(pin);
*(pout++) = *(pin++);
length = func(code_low);
unsigned func(unsigned int code_low)
return code_low + 3;
length = func(code_low);
memset( pout, *pin++, length );
0

13373 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2393
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf, size_t outlen, int *err)
unsigned char * pout = outbuf;
int length;
int offset;
if ( !(bit_mask & bit_value) ){
if ( pout + 1 > pout_end )
{*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );                       }
*(pout++) = *(pin++);
offset = code_low + ((unsigned int)(*pin++) << 4) + 3;
if ( pout - offset + length > pout )
*err = WTAP_ERR_UNC_BAD_OFFSET;
return ( -1 );}
length = func(code_type);
int func(int code_type)
return code_type;
length = func(code_type);
if ( pout + length > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );}
memcpy( pout, pout - offset, length );
0

13398 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2301
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf,
size_t outlen, int *err)
unsigned char * pin  = inbuf;
unsigned char * pout = outbuf;
if ( 0 == bit_mask )              {
bit_mask  = 0x8000;
bit_value = pletoh16(pin);
pin += 2;
if ( !(bit_mask & bit_value) ){
*(pout++) = *(pin++);}
*(pout++) = *(pin++);
code_type = (unsigned int) ((*pin) >> 4 ) & 0xF;
code_low  = (unsigned int) ((*pin) & 0xF );
pin++;
bit_value = pletoh16(pin);
*(pout++) = *(pin++);
length = func(code_low);
unsigned func(unsigned int code_low)
return code_low + 3;
length = func(code_low);
memset( pout, *pin++, length );
1

13399 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2393
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf, size_t outlen, int *err)
unsigned char * pout = outbuf;
int length;
int offset;
if ( !(bit_mask & bit_value) )
*(pout++) = *(pin++);		}
offset = code_low + ((unsigned int)(*pin++) << 4) + 3;
if ( pout - offset < outbuf )
*err = WTAP_ERR_UNC_BAD_OFFSET;
return ( -1 );}
length = func(code_type);
int func(int code_type)
return code_type;
length = func(code_type);
if ( pout + length > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );}
memcpy( pout, pout - offset, length );
1

13436 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2301
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf,
size_t outlen, int *err)
unsigned char * pin  = inbuf;
unsigned char * pout = outbuf;
if ( pin + 2 >= pin_end ) {
*err = WTAP_ERR_UNC_TRUNCATED;
return ( -1 );                        }
bit_mask  = 0x8000;
bit_value = pletoh16(pin);
pin += 2;
if ( !(bit_mask & bit_value) )
if ( pout + 1 > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );
*(pout++) = *(pin++);
*(pout++) = *(pin++);
code_type = (unsigned int) ((*pin) >> 4 ) & 0xF;
code_low  = (unsigned int) ((*pin) & 0xF );
pin++;
bit_value = pletoh16(pin);
*(pout++) = *(pin++);
length = code_low + 3;
int *dataType = &length;
length = *dataType;
memset( pout, *pin++, length );
0

13437 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2393
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf, size_t outlen, int *err)
unsigned char * pout = outbuf;
int length;
int offset;
if ( !(bit_mask & bit_value) ){
if ( pout + 1 > pout_end )
{*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );                       }
*(pout++) = *(pin++);
offset = code_low + ((unsigned int)(*pin++) << 4) + 3;
int *dataType = &offset;
if ( pout - offset + length > pout )
*err = WTAP_ERR_UNC_BAD_OFFSET;
return ( -1 );}
length = code_type;
if ( pout + length > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );}
length = *dataType;
memcpy( pout, pout - offset, length );
0

13474 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2301
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf,
size_t outlen, int *err)
unsigned char * pin  = inbuf;
unsigned char * pout = outbuf;
if ( 0 == bit_mask )              {
bit_mask  = 0x8000;
bit_value = pletoh16(pin);
pin += 2;
if ( !(bit_mask & bit_value) ){
*(pout++) = *(pin++);}
*(pout++) = *(pin++);
code_type = (unsigned int) ((*pin) >> 4 ) & 0xF;
code_low  = (unsigned int) ((*pin) & 0xF );
pin++;
bit_value = pletoh16(pin);
*(pout++) = *(pin++);
length = code_low + 3;
int *dataType = &length;
length = *dataType;
memset( pout, *pin++, length );
1

13475 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2393
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf, size_t outlen, int *err)
unsigned char * pout = outbuf;
int length;
int offset;
if ( !(bit_mask & bit_value) )
*(pout++) = *(pin++);		}
offset = code_low + ((unsigned int)(*pin++) << 4) + 3;
int *dataType = &offset;
if ( pout - offset < outbuf )
*err = WTAP_ERR_UNC_BAD_OFFSET;
return ( -1 );}
length = code_type;
if ( pout + length > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );}
length = *dataType;
memcpy( pout, pout - offset, length );
1

13492 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2301
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf,
size_t outlen, int *err)
unsigned char * pin  = inbuf;
unsigned char * pout = outbuf;
if ( pin + 2 >= pin_end ) {
*err = WTAP_ERR_UNC_TRUNCATED;
return ( -1 );                        }
bit_mask  = 0x8000;
bit_value = pletoh16(pin);
pin += 2;
if ( !(bit_mask & bit_value) )
if ( pout + 1 > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );
*(pout++) = *(pin++);
*(pout++) = *(pin++);
code_type = (unsigned int) ((*pin) >> 4 ) & 0xF;
code_low  = (unsigned int) ((*pin) & 0xF );
pin++;
bit_value = pletoh16(pin);
*(pout++) = *(pin++);
structType myStruct;
myStruct.structFirst = code_low;
length = func(myStruct);
unsigned func(structType myStruct)
unsigned int code_low = myStruct.structFirst;
return code_low + 3;
length = func(myStruct);
memset( pout, *pin++, length );
0

13493 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2393
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf, size_t outlen, int *err)
unsigned char * pout = outbuf;
int length;
int offset;
if ( !(bit_mask & bit_value) ){
if ( pout + 1 > pout_end )
{*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );                       }
*(pout++) = *(pin++);
offset = code_low + ((unsigned int)(*pin++) << 4) + 3;
if ( pout - offset + length > pout )
*err = WTAP_ERR_UNC_BAD_OFFSET;
return ( -1 );}
structType myStruct;
myStruct.structFirst = code_type;
length = func(myStruct);
int func(structType myStruct)
int code_type = myStruct.structFirst;
return code_type;
length = func(myStruct);
if ( pout + length > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );}
memcpy( pout, pout - offset, length );
0

13510 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2301
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf,
size_t outlen, int *err)
unsigned char * pin  = inbuf;
unsigned char * pout = outbuf;
if ( 0 == bit_mask )              {
bit_mask  = 0x8000;
bit_value = pletoh16(pin);
pin += 2;
if ( !(bit_mask & bit_value) ){
*(pout++) = *(pin++);}
*(pout++) = *(pin++);
code_type = (unsigned int) ((*pin) >> 4 ) & 0xF;
code_low  = (unsigned int) ((*pin) & 0xF );
pin++;
bit_value = pletoh16(pin);
*(pout++) = *(pin++);
structType myStruct;
myStruct.structFirst = code_low;
length = func(myStruct);
unsigned func(structType myStruct)
unsigned int code_low = myStruct.structFirst;
return code_low + 3;
length = func(myStruct);
memset( pout, *pin++, length );
1

13511 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2393
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf, size_t outlen, int *err)
unsigned char * pout = outbuf;
int length;
int offset;
if ( !(bit_mask & bit_value) )
*(pout++) = *(pin++);		}
offset = code_low + ((unsigned int)(*pin++) << 4) + 3;
if ( pout - offset < outbuf )
*err = WTAP_ERR_UNC_BAD_OFFSET;
return ( -1 );}
structType myStruct;
myStruct.structFirst = code_type;
length = func(myStruct);
int func(structType myStruct)
int code_type = myStruct.structFirst;
return code_type;
length = func(myStruct);
if ( pout + length > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );}
memcpy( pout, pout - offset, length );
1

13528 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2301
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf,
size_t outlen, int *err)
unsigned char * pin  = inbuf;
unsigned char * pout = outbuf;
if ( pin + 2 >= pin_end ) {
*err = WTAP_ERR_UNC_TRUNCATED;
return ( -1 );                        }
bit_mask  = 0x8000;
bit_value = pletoh16(pin);
pin += 2;
if ( !(bit_mask & bit_value) )
if ( pout + 1 > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );
*(pout++) = *(pin++);
*(pout++) = *(pin++);
code_type = (unsigned int) ((*pin) >> 4 ) & 0xF;
code_low  = (unsigned int) ((*pin) & 0xF );
pin++;
bit_value = pletoh16(pin);
*(pout++) = *(pin++);
unionType myUnion;
myUnion.unionFirst = code_low;
length = func(myUnion);
unsigned func(unionType myUnion)
unsigned int code_low = myUnion.unionSecond;
return code_low + 3;
length = func(myUnion);
memset( pout, *pin++, length );
0

13529 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2393
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf, size_t outlen, int *err)
unsigned char * pout = outbuf;
int length;
int offset;
if ( !(bit_mask & bit_value) ){
if ( pout + 1 > pout_end )
{*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );                       }
*(pout++) = *(pin++);
offset = code_low + ((unsigned int)(*pin++) << 4) + 3;
if ( pout - offset + length > pout )
*err = WTAP_ERR_UNC_BAD_OFFSET;
return ( -1 );}
unionType myUnion;
myUnion.unionFirst = code_type;
length = func(myUnion);
int func(unionType myUnion)
int code_type = myUnion.unionSecond;
return code_type;
length = func(myUnion);
if ( pout + length > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );}
memcpy( pout, pout - offset, length );
0

13546 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2301
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf,
size_t outlen, int *err)
unsigned char * pin  = inbuf;
unsigned char * pout = outbuf;
if ( 0 == bit_mask )              {
bit_mask  = 0x8000;
bit_value = pletoh16(pin);
pin += 2;
if ( !(bit_mask & bit_value) ){
*(pout++) = *(pin++);}
*(pout++) = *(pin++);
code_type = (unsigned int) ((*pin) >> 4 ) & 0xF;
code_low  = (unsigned int) ((*pin) & 0xF );
pin++;
bit_value = pletoh16(pin);
*(pout++) = *(pin++);
unionType myUnion;
myUnion.unionFirst = code_low;
length = func(myUnion);
unsigned func(unionType myUnion)
unsigned int code_low = myUnion.unionSecond;
return code_low + 3;
length = func(myUnion);
memset( pout, *pin++, length );
1

13547 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2393
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf, size_t outlen, int *err)
unsigned char * pout = outbuf;
int length;
int offset;
if ( !(bit_mask & bit_value) )
*(pout++) = *(pin++);		}
offset = code_low + ((unsigned int)(*pin++) << 4) + 3;
if ( pout - offset < outbuf )
*err = WTAP_ERR_UNC_BAD_OFFSET;
return ( -1 );}
unionType myUnion;
myUnion.unionFirst = code_type;
length = func(myUnion);
int func(unionType myUnion)
int code_type = myUnion.unionSecond;
return code_type;
length = func(myUnion);
if ( pout + length > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );}
memcpy( pout, pout - offset, length );
1

13569 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2301
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf,
size_t outlen, int *err)
unsigned char * pout = outbuf;
unsigned char * pin  = inbuf;
if ( pin + 2 >= pin_end ) {
*err = WTAP_ERR_UNC_TRUNCATED;
return ( -1 );                        }
bit_value = pletoh16(pin);
bit_mask  = 0x8000;
pin += 2;
if ( !(bit_mask & bit_value) )
if ( pout + 1 > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );
*(pout++) = *(pin++);
*(pout++) = *(pin++);
code_type = (unsigned int) ((*pin) >> 4 ) & 0xF;
code_low  = (unsigned int) ((*pin) & 0xF );
pin++;
bit_value = pletoh16(pin);
*(pout++) = *(pin++);
length = code_low + 3;
memset( pout, *pin++, length );
0

13591 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2301
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf,
size_t outlen, int *err)
unsigned char * pout = outbuf;
unsigned char * pin  = inbuf;
if ( 0 == bit_mask )              {
bit_value = pletoh16(pin);
bit_mask  = 0x8000;
pin += 2;
if ( !(bit_mask & bit_value) ){
*(pout++) = *(pin++);}
*(pout++) = *(pin++);
code_type = (unsigned int) ((*pin) >> 4 ) & 0xF;
code_low  = (unsigned int) ((*pin) & 0xF );
pin++;
bit_value = pletoh16(pin);
length = code_low + 3;
*(pout++) = *(pin++);
memset( pout, *pin++, length );
1

13986 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2301
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf,
size_t outlen, int *err)
unsigned char * pin  = inbuf;
unsigned char * pout = outbuf;
if ( pin + 2 >= pin_end ) {
*err = WTAP_ERR_UNC_TRUNCATED;
return ( -1 );                        }
bit_mask  = 0x8000;
bit_value = pletoh16(pin);
pin += 2;
if ( !(bit_mask & bit_value) )
if ( pout + 1 > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );
*(pout++) = *(pin++);
*(pout++) = *(pin++);
code_type = (unsigned int) ((*pin) >> 4 ) & 0xF;
code_low  = (unsigned int) ((*pin) & 0xF );
pin++;
bit_value = pletoh16(pin);
*(pout++) = *(pin++);
length = code_low + 3;
memset( pout, *pin++, length );
0

13987 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2393
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf, size_t outlen, int *err)
unsigned char * pout = outbuf;
int length;
int offset;
if ( !(bit_mask & bit_value) ){
if ( pout + 1 > pout_end )
{*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );                       }
*(pout++) = *(pin++);
offset = code_low + ((unsigned int)(*pin++) << 4) + 3;
if ( pout - offset + length > pout )
*err = WTAP_ERR_UNC_BAD_OFFSET;
return ( -1 );}
length = code_type;
if ( pout + length > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );}
memcpy( pout, pout - offset, length );
0

14024 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2301
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf,
size_t outlen, int *err)
unsigned char * pin  = inbuf;
unsigned char * pout = outbuf;
if ( 0 == bit_mask )              {
bit_mask  = 0x8000;
bit_value = pletoh16(pin);
pin += 2;
if ( !(bit_mask & bit_value) ){
*(pout++) = *(pin++);}
*(pout++) = *(pin++);
code_type = (unsigned int) ((*pin) >> 4 ) & 0xF;
code_low  = (unsigned int) ((*pin) & 0xF );
pin++;
bit_value = pletoh16(pin);
*(pout++) = *(pin++);
length = code_low + 3;
memset( pout, *pin++, length );
1

14025 CVE-2014-6431/Wireshark_1.12.0_CVE_2014_6431_wiretap_ngsniffer.c Buffer_Overflow_boundedcpy 2393
static int SnifferDecompress(unsigned char *inbuf, size_t inlen, unsigned char *outbuf, size_t outlen, int *err)
unsigned char * pout = outbuf;
int length;
int offset;
if ( !(bit_mask & bit_value) )
*(pout++) = *(pin++);		}
offset = code_low + ((unsigned int)(*pin++) << 4) + 3;
if ( pout - offset < outbuf )
*err = WTAP_ERR_UNC_BAD_OFFSET;
return ( -1 );}
length = code_type;
if ( pout + length > pout_end )
*err = WTAP_ERR_UNC_OVERFLOW;
return ( -1 );}
memcpy( pout, pout - offset, length );
1

